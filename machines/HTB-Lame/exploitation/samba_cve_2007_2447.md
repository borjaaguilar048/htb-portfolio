# Explotación de Samba — CVE-2007-2447

##  Resumen
Durante la fase de enumeración se identificó un servicio **Samba smbd 3.0.20 (Debian)** expuesto en los puertos **139 y 445**.  
Esta versión es vulnerable a **CVE-2007-2447**, una vulnerabilidad crítica que permite **ejecución remota de comandos como root** sin necesidad de autenticación.

---

##  Servicio afectado

- Servicio: Samba (smbd)
- Versión: 3.0.20
- Puertos: 139 / 445
- Sistema operativo: Linux (Debian)

La versión detectada es antigua y conocida por contener múltiples vulnerabilidades públicas.

---

##  Análisis de la vulnerabilidad

**CVE-2007-2447** se produce debido a una mala sanitización del nombre de usuario cuando Samba utiliza el parámetro interno **`username map script`**.

### Impacto:
- El nombre de usuario no se filtra correctamente
- Es posible inyectar comandos del sistema
- Los comandos se ejecutan con privilegios **root**
- No se requieren credenciales válidas

Esto provoca una **Remote Command Execution (RCE)** crítica.

---

##  Identificación del exploit

Se buscaron exploits públicos asociados a la versión detectada:

searchsploit samba 3.0.20

## Se identificó el exploit correspondiente a:

CVE-2007-2447

Username map script command execution

Tras varios intentos manuales, la explotación se realizó de forma estable utilizando Metasploit.

## Módulo utilizado:

exploit/multi/samba/usermap_script

## Configuración básica:

RHOSTS: IP de la máquina objetivo

PAYLOAD: reverse shell Unix

LHOST: IP de la máquina atacante

Una vez configurado el módulo, se ejecutó el exploit y se obtuvo una shell interactiva.

## Verificación del acceso

Tras obtener la sesión, se verificó el nivel de privilegios:

whoami

Resultado:

Usuario: root

Esto confirma la ejecución remota de comandos con privilegios máximos y el compromiso total del sistema.

## Resultado final

Tipo de vulnerabilidad: Remote Command Execution

Vector de ataque: Samba

Autenticación requerida: No

Escalada de privilegios: No necesaria

Acceso obtenido: root

## Conclusión

Esta vulnerabilidad demuestra la importancia de:

Mantener servicios actualizados

No exponer versiones antiguas a redes no confiables

Realizar una correcta validación de entradas

La explotación de CVE-2007-2447 permite comprometer completamente un sistema con un único vector mal protegido.

## Disclaimer

Este ataque fue realizado únicamente con fines educativos en un laboratorio controlado de Hack The Box.
No debe reproducirse en sistemas sin autorización explícita.




